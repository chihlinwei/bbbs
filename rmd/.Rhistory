scale_shape_manual(values=c(19,1))+
labs(x="Depth (m)", y=expression(Density~(Ind~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large #%+replace% dark
loc <- dat.mean.mean
coordinates(loc) <- c("Longitude", "Latitude")
extra <- function(...){
panel.levelplot.raster(...)
sp.lines(isobath, col="gray30")
sp.points(loc, cex=2, pch=19, col=level.colors(loc$Density, at = 10^pretty(log10(loc$Density), 100), col.regions=jet.colors))
}
tbspplot(r, panel=extra)
dat <- subset(mac, Size<100)
dat <- subset(dat, Cruise=="OR1_1096"|Cruise=="OR1_1102"|Cruise=="OR1_1126")
dat.sum <- summaryBy(Size+Area+Longitude+Latitude+Depth~Region+Habitat+Cruise+Station+Deployment+Tube, data=dat, FUN=c(sum, mean))
dat.sum$Biomass <- dat.sum$Size.sum/dat.sum$Area.mean
dat.mean <- summaryBy(Biomass+Longitude.mean+Latitude.mean+Depth.mean~Region+Habitat+Cruise+Station, data=dat.sum, FUN=c(mean, sd, length))
dat <- subset(mac, Size<100)
dat <- subset(dat, Cruise=="OR1_1096"|Cruise=="OR1_1102"|Cruise=="OR1_1126")
dat.sum <- summaryBy(Size+Area+Longitude+Latitude+Depth~Region+Habitat+Cruise+Station+Deployment+Tube, data=dat, FUN=c(sum, mean))
dat.sum$Biomass <- dat.sum$Size.sum/dat.sum$Area.mean
# Exclude 2 samples from OR1 1196 GC3 with unusally high biomass
#dat.sum <- subset(dat.sum, !(Cruise=="OR1_1096" & Station=="GC3" & (Tube=="2"|Tube=="3")))
dat.mean <- summaryBy(Biomass+Longitude.mean+Latitude.mean+Depth.mean~Region+Habitat+Cruise+Station, data=dat.sum, FUN=c(mean, sd, length))
dat.mean$Biomass.se <- dat.mean$Biomass.sd/dat.mean$Biomass.length^0.5
# Bad core at OR1 1102 GS4 (sediment only 19 cm)
bad <- with(dat.mean, Cruise=="OR1_1102"&Station=="GS4")
dat.mean <- subset(dat.mean, !bad)
out <- dat.mean[, c("Region", "Habitat", "Cruise", "Station", "Longitude.mean.mean", "Latitude.mean.mean", "Depth.mean.mean", "Biomass.length", "Biomass.mean", "Biomass.sd", "Biomass.se")]
names(out) <- c("Region", "Habitat", "Cruise", "Station", "Longitude", "Latitude", "Depth", "n", "Biomass", "sd", "se")
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
scale_shape_manual(values=c(19,1))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large %+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
scale_shape_manual(values=c(19,1))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
#scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
scale_shape_manual(values=c(19,1))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
geom_errorbar()+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_linetype_manual(values=c(1,2))+
scale_shape_manual(values=c(19,1))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
loc <- out
coordinates(loc) <- c("Longitude", "Latitude")
extra <- function(...){
panel.levelplot.raster(...)
sp.lines(isobath, col="gray30")
sp.points(loc, cex=32, pch=19, col=level.colors(loc$Biomass, at = 10^pretty(log10(loc$Biomass), 100), col.regions=jet.colors))
}
tbspplot(r, panel=extra)
out$Longitude <- round(out$Longitude, 4)
out$Latitude <- round(out$Latitude, 4)
out$Depth <- round(out$Depth, 0)
out$Biomass <- round(out$Biomass, 0)
out$sd <- round(out$sd, 1)
out$se <- round(out$se, 1)
kable(out, align="c")
extra <- function(...){
panel.levelplot.raster(...)
sp.lines(isobath, col="gray30")
sp.points(loc, cex=2, pch=19, col=level.colors(loc$Biomass, at = 10^pretty(log10(loc$Biomass), 100), col.regions=jet.colors))
}
tbspplot(r, panel=extra)
out$Longitude <- round(out$Longitude, 4)
out$Latitude <- round(out$Latitude, 4)
out$Depth <- round(out$Depth, 0)
out$Biomass <- round(out$Biomass, 0)
out$sd <- round(out$sd, 1)
out$se <- round(out$se, 1)
kable(out, align="c")
dat.mean <- summaryBy(Biomass+Longitude+Latitude+Depth~Region+Habitat+Station, data=out, FUN=c(mean, sd, length))
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
dat.mean <- summaryBy(Biomass+Longitude+Latitude+Depth~Region+Habitat+Station, data=out, FUN=c(mean, sd, length))
dat.mean$Biomass.se <- dat.mean$Biomass.sd/dat.mean$Biomass.length^0.5
out <- dat.mean[, c("Region", "Habitat", "Station", "Longitude.mean", "Latitude.mean", "Depth.mean", "Biomass.length", "Biomass.mean", "Biomass.sd", "Biomass.se")]
names(out) <- c("Region", "Habitat", "Station", "Longitude", "Latitude", "Depth", "n", "Biomass", "sd", "se")
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se*1.96), ymax=(Biomass+se*1.96),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
#scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se), ymax=(Biomass+se),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
#scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se), ymax=(Biomass+se),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se), ymax=(Biomass+se),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x, se=FALSE)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se), ymax=(Biomass+se),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x, se=FALSE)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
#scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
ggplot(data=out,
aes(x=Depth, y=Biomass,
ymin=(Biomass-se), ymax=(Biomass+se),
shape=Habitat, colour=Habitat, fill=Habitat))+
geom_point(size=5)+
stat_smooth(method="lm", formula=y~x, se=FALSE)+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Biomass~(mg~m^-2)))+
scale_y_log10()+
#facet_wrap(~Habitat, scales="free_x")+
theme_bw() %+replace% large #%+replace% dark
knitr::opts_chunk$set(echo = TRUE, warning = FALSE)
cord   <- read_excel("../GPSC_data/GPSC_meio_sorting/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
# Sorting data
mei_a   <- read_excel("../GPSC_data/GPSC_meio_sorting/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
Category <- as.character(mei_a$Taxon)
Category[Category=="Copepoda"] <- "Harpacticoida"
Category[Category!="Nematoda"&Category!="Harpacticoida"] <- "Others"
mei_a <- cbind(Category, mei_a)
mei_a <- subset(mei_a, Subcore!="water")
mei_a <- summaryBy(Abundance~Category+Cruise+Station+Taxon, data=mei_a, FUN=c(mean, sd, length), keep.names=T)
names(mei_a)[5:7] <- c("Abundance", "sd", "n")
# Match the sample names (tube) in size data to the sample names (tube) in sorting data
# Extract the total abudance from the sorting data
sn <- with(mei_a, paste(Category, Cruise, Station, sep="|"))
abund <- mei_a[match(names(mei), sn),]$Abundance
# Resample the size data (with replacement) by the total abundance in each sample
sample_fun <-
function(i){
keep <- sample(1:dim(mei[[i]])[1], si=abund[i], replace=TRUE)
mei[[i]][keep,]
}
library(doSNOW)
library(foreach)
# Simulated size data
cl<-makeCluster(4) # change the 4 to your number of CPU cores
registerDoSNOW(cl) # register the SNOW parallel backend with the foreach package
simu <- foreach(i=1:length(mei)) %dopar% sample_fun(i)
mei_a
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
out$Density <- out$Abundance.mean/(pi*(2.5/2)^2/10000)
out$sd <- out$Abundance.sd/(pi*(2.5/2)^2/10000)
keep <- match(paste(out$Cruise, out$Station), paste(cord$Cruise, cord$Station))
out <- cbind(cord[keep, 3:9], out[, 5:6])
ggplot(data= out,
aes(x=Depth, y=Density, ymin=(Density-sd), ymax=(Density+sd), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
kable(out)
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
out$Density <- out$Abundance.mean/(pi*(2.5/2)^2/10000)
out$sd <- out$Abundance.sd/(pi*(2.5/2)^2/10000)
keep <- match(paste(out$Cruise, out$Station), paste(cord$Cruise, cord$Station))
out <- cbind(cord[keep, 3:9], out[, 5:6])
ggplot(data= out,
aes(x=Depth, y=Density, ymin=(Density-sd), ymax=(Density+sd), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
kable(out)
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
out$Density <- out$Abundance.mean/(pi*(2.5/2)^2/10000)
out$sd <- out$Abundance.sd/(pi*(2.5/2)^2/10000)
keep <- match(paste(out$Cruise, out$Station), paste(cord$Cruise, cord$Station))
out <- cbind(cord[keep, 3:9], out[, 5:6])
ggplot(data= out,
aes(x=Depth, y=Density, ymin=(Density-sd), ymax=(Density+sd), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
kable(out)
ggplot(data= out,
aes(x=Depth, y=Density, ymin=(Density-sd), ymax=(Density+sd), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
Category <- as.character(mei_a$Taxon)
Category[Category=="Copepoda"] <- "Harpacticoida"
Category[Category!="Nematoda"&Category!="Harpacticoida"] <- "Others"
mei_a <- cbind(Category, mei_a)
mei_a <- subset(mei_a, Subcore!="water")
head(mei_a)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=mei_a, FUN=sum, keep.names=T)
mei_a
summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
mei_a$Density <- mei_a$Abundance/(pi*(2.5/2)^2/10000)
mei_a
mei_a <- summaryBy(Density~Cruise+Station, data=mei_a, FUN=c(mean, sd, length), keep.names = TRUE)
mei_a
mei_a$Density.se <- mei_a$Density.sd/mei_a$Density.length^0.5
mei_a
keep <- match(paste(mei_a$Cruise, mei_a$Station), paste(cord$Cruise, cord$Station))
head(cord)
head(mei_a)
mei_a<- cbind(cord[keep, 3:9], mei_a[, 3:6])
head(mei_a)
names(mei_a)[8:11] <- c("Density", "sd", "n", "se")
ggplot(data= mei_a,
aes(x=Depth, y=Density, ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=Density, ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=Density, ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=log10(Density), ymin=log10(Density-se), ymax=log10(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
#scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat, fill=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
out <- summaryBy(Abundance~Cruise+Station, data=mei_a, FUN=c(mean, sd), keep.names = TRUE)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=mei_a, FUN=sum, keep.names=T)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=mei_a, FUN=sum, keep.names=T)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=mei_a, FUN=sum, keep.names=T)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=as.data.frame(mei_a), FUN=sum, keep.names=T)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=as.data.frame(mei_a), FUN=sum, keep.names=T)
mei_a$Density <- mei_a$Abundance/(pi*(2.5/2)^2/10000)
mei_a <- summaryBy(Density~Cruise+Station, data=mei_a, FUN=c(mean, sd, length), keep.names = TRUE)
mei_a$Density.se <- mei_a$Density.sd/mei_a$Density.length^0.5
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
keep <- match(paste(mei_a$Cruise, mei_a$Station), paste(cord$Cruise, cord$Station))
out<- cbind(cord[keep, 3:9], mei_a[, 3:6])
names(outa)[8:11] <- c("Density", "sd", "n", "se")
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=as.data.frame(mei_a), FUN=sum, keep.names=T)
mei_a$Density <- mei_a$Abundance/(pi*(2.5/2)^2/10000)
mei_a <- summaryBy(Density~Cruise+Station, data=mei_a, FUN=c(mean, sd, length), keep.names = TRUE)
mei_a$Density.se <- mei_a$Density.sd/mei_a$Density.length^0.5
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
keep <- match(paste(mei_a$Cruise, mei_a$Station), paste(cord$Cruise, cord$Station))
out<- cbind(cord[keep, 3:9], mei_a[, 3:6])
names(out)[8:11] <- c("Density", "sd", "n", "se")
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat, fill=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
head(out)
ggplot(data= mei_a,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat, fill=Habitat))+
geom_point(size=5)
# Sorting data
mei_a   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=2)
mei_a <- summaryBy(Abundance~Cruise+Station+Station+Deployment+Tube+Subcore, data=as.data.frame(mei_a), FUN=sum, keep.names=T)
mei_a$Density <- mei_a$Abundance/(pi*(2.5/2)^2/10000)
mei_a <- summaryBy(Density~Cruise+Station, data=mei_a, FUN=c(mean, sd, length), keep.names = TRUE)
mei_a$Density.se <- mei_a$Density.sd/mei_a$Density.length^0.5
cord   <- read_excel("../excel/GPSC_meio_sorting_2016.08.18.xlsx", sheet=1)
keep <- match(paste(mei_a$Cruise, mei_a$Station), paste(cord$Cruise, cord$Station))
out<- cbind(cord[keep, 3:9], mei_a[, 3:6])
names(out)[8:11] <- c("Density", "sd", "n", "se")
ggplot(data= out,
aes(x=Depth, y=(Density), ymin=(Density-se), ymax=(Density+se), colour=Habitat, fill=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
geom_errorbar()+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_colour_manual(values=c("black","gray"))+
scale_fill_manual(values=c("black","gray"))+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
out$Longitude <- round(out$Longitude, 4)
out$Latitude <- round(out$Latitude, 4)
out$Depth <- round(out$Depth, 0)
out$Density <- round(out$Density, 0)
out$sd <- round(out$sd, 1)
out$se <- round(out$se, 1)
kable(out, align="c")
out <- summaryBy(Longitude+Latitude+Depth+Density~Habitat+Station, data=out, FUN=mean, keep.names = TRUE)
ggplot(data= out,
aes(x=Depth, y=Density, colour=Habitat))+
geom_point(size=5)+
scale_shape_manual(values=c(19,1))+
stat_smooth(method="lm", formula=y~x, alpha=0.2)+
scale_linetype_manual(values=c(1,2))+
labs(x="Depth (m)", y=expression(Density~(Indiv~m^-2)))+
scale_y_log10()+
theme_bw() %+replace% large
kable(out)
